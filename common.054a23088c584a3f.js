"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[592],{6581:(d,h,i)=>{i.d(h,{l:()=>f});var _=i(2340),u=i(591),a=i(1737),s=i(1086),n=i(7545),o=i(7221),l=i(5e3),p=i(520);let f=(()=>{class r{constructor(t){this._httpClient=t,this.apiHost=_.N.apiHost,this._authenticated=!1,this._playerInfo=new u.X(null)}set accessToken(t){sessionStorage.removeItem("access_token"),sessionStorage.setItem("access_token",t)}get accessToken(){var t;return null!==(t=sessionStorage.getItem("access_token"))&&void 0!==t?t:""}get playerInfo$(){return this._playerInfo.asObservable()}set playerInfo(t){this._playerInfo.next(t)}playerSignIn(t){return this._authenticated?(0,a._)("User is already logged in."):this._httpClient.post(`${this.apiHost}fsr/player/login/`,t).pipe((0,n.w)(e=>(this.accessToken=e.token,this._authenticated=!0,(0,s.of)(e))))}playerSessionSignIn(t){return this._authenticated?(0,a._)("User is already logged in."):this._httpClient.post(`${this.apiHost}fsr/session/login/`,t).pipe((0,n.w)(e=>(this.accessToken=e.token,this._authenticated=!0,(0,s.of)(e))))}getSessionDetails(){return this._httpClient.get(`${this.apiHost}fsr/session/`).pipe((0,n.w)(t=>(0,s.of)(t)))}verifyPlayerLanding(t){return this._httpClient.post(`${this.apiHost}fsr/player/setup`,t).pipe((0,o.K)(e=>(0,a._)(e)),(0,n.w)(e=>(this.accessToken=e.token,this._authenticated=!0,(0,s.of)(e))))}verifyReportSubmission(t){return this._httpClient.post(`${this.apiHost}fsr/session/handshake`,t).pipe((0,o.K)(e=>(0,a._)(e)),(0,n.w)(e=>(this.accessToken=e.token,(0,s.of)(e))))}updatePlayer(t){return this._httpClient.put(`${this.apiHost}fsr/player`,t).pipe((0,o.K)(e=>(0,a._)(e)),(0,n.w)(e=>(0,s.of)(e)))}validateToken(){return this._httpClient.post(`${this.apiHost}fsr/player/validate-token`,{}).pipe((0,o.K)(()=>(0,s.of)(!1)),(0,n.w)(t=>(this._authenticated=null==t?void 0:t.valid,(0,s.of)(null==t?void 0:t.valid))))}check(){let t=(0,s.of)(!1);return this._authenticated&&(t=(0,s.of)(!0)),t=this.accessToken?this.validateToken():(0,s.of)(!1),t}}return r.\u0275fac=function(t){return new(t||r)(l.LFG(p.eN))},r.\u0275prov=l.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})()}}]);